<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.9.2" />
<title>pyflarum.session API documentation</title>
<meta name="description" content="" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}#lunr-search{width:100%;font-size:1em;padding:6px 9px 5px 9px;border:1px solid silver}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>pyflarum.session</code></h1>
</header>
<section id="section-intro">
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/CWKevo/pyFlarum/blob/a65fc09d5ae7d6cb04d63d7abe39aabe0cf03c52/pyflarum\session.py#L0-L547" class="git-link">Browse git</a>
</summary>
<pre><code class="python">from typing import Any, BinaryIO, Iterable, Optional, Literal, TYPE_CHECKING
if TYPE_CHECKING:
    from .custom_types import AnyUser


import warnings

from datetime import datetime
from requests import Session
from urllib.parse import urlparse


from .flarum.core.forum import Forum

from .flarum.core.users import MyUser, User, Users
from .flarum.core.notifications import Notifications
from .flarum.core.groups import Group, Groups

from .flarum.core.discussions import Discussion, Discussions
from .flarum.core.posts import Post, Posts

from .flarum.core.filters import Filter


from .error_handler import MissingExtensionWarning, MissingExtensionError, parse_request
from .datetime_conversions import datetime_to_flarum


from .extensions import ExtensionMixin


__all__ = [&#39;FlarumSession&#39;, &#39;FlarumUser&#39;]



class FlarumSession:
    &#34;&#34;&#34;
        The main object that carries the Flarum session.
    &#34;&#34;&#34;

    def __init__(self, forum_url: str, username_or_email: Optional[str]=None, password: Optional[str]=None, api_endpoint: str=&#34;api&#34;, user_agent: str=&#39;pyflarum&#39;, session_object: &#39;Session | Any&#39;=Session()):
        &#34;&#34;&#34;
            ### Parameters:
            - `forum_url` - the forum URL that you want the bot to fetch/update data from.
            - `username_or_email` - optional. The username or E-mail address to log into. If `None`, then the user isn&#39;t logged in.
            - `password` - optional. The user&#39;s password. If `None`, then the user isn&#39;t logged in.
            - `api_endpoint` - the API endpoint of the forum, without slashes. This can be specified in Flarum&#39;s `config.php` and normally forums don&#39;t need to change the default `&#39;api&#39;`
            - `user_agent` - the user agent that will be used to make all requests. Defaults to `&#39;pyflarum&#39;`.
            - `session_object` - the `Session` object to make requests with. You can pass any object that supports all operations from the [requests](https://pypi.org/project/requests/) library, check [requests_cache](https://pypi.org/project/requests-cache/) as an example.
            ```
        &#34;&#34;&#34;

        if not forum_url.startswith(&#34;http&#34;):
            raise TypeError(f&#39;Invalid protocol used in `forum_url` ({forum_url}) - expected either &#34;https://&#34; or &#34;http://&#34;&#39;)

        parsed_url = urlparse(forum_url, scheme=&#34;https&#34;)
        self.forum_url = f&#34;{parsed_url.scheme}://{parsed_url.hostname}&#34;

        self.api_endpoint = api_endpoint
        self.username_or_email = username_or_email
        self.session = session_object

        self.session.headers.update({
            &#34;User-Agent&#34;: user_agent
        })


        self.authenticate(username_or_email, password)


    def __str__(self) -&gt; str:
        return f&#39;&lt;{type(self).__name__}&gt; authenticated={self.is_authenticated}; username={self.username_or_email}&#39;


    def __repr__(self) -&gt; str:
        return self.__str__()


    def authenticate(self, username_or_email: Optional[str]=None, password: Optional[str]=None) -&gt; None:
        &#34;&#34;&#34;
            Authenticates your user. This can be run after `FlarumUser` was initialized, to switch to a different user. You can even change
            `FlarumUser.forum_url` to login to another forum.

            ### Parameters:
            - `username_or_email` - optional. The username or E-mail address to log into. If `None`, then the user isn&#39;t logged in.
            - `password` - optional. The user&#39;s password. If `None`, then the user isn&#39;t logged in.
        &#34;&#34;&#34;

        if username_or_email and password:
            identification_data = {&#34;identification&#34;: username_or_email, &#34;password&#34;: password}

            raw = self.session.post(url=f&#39;{self.forum_url}/api/token&#39;, json=identification_data)
            token_data = parse_request(raw)

            token = token_data.get(&#34;token&#34;, None)
            user_id = token_data.get(&#34;userId&#34;, None)

            if token:
                self.session.headers.update({
                    &#34;Authorization&#34;: f&#39;Token {token}; userId={user_id}&#39;,
                })

                self.is_authenticated = True

            else:
                self.is_authenticated = False

        else:
            self.session.headers.update({
                &#34;Authorization&#34;: None,
            })

            self.is_authenticated = False


    @property
    def api_urls(self) -&gt; dict[str, str]:
        &#34;&#34;&#34;
            Simple, hardcoded `&#39;key: value&#39;` `dict` of Flarum&#39;s API routes for quick access.

            API routes reference (old):
            https://github.com/flarum/flarum.github.io/blob/20322c0e6011e4f304ae7e95f41594a0b086bc27/_docs/api.md
        &#34;&#34;&#34;

        return {
            &#34;base&#34;: f&#34;{self.forum_url}/{self.api_endpoint}&#34;,
            &#34;forum&#34;: f&#34;{self.forum_url}/{self.api_endpoint}/forum&#34;,

            &#34;settings&#34;: f&#34;{self.forum_url}/{self.api_endpoint}/settings&#34;,
            &#34;extensions&#34;: f&#34;{self.forum_url}/{self.api_endpoint}/extensions&#34;,

            &#34;discussions&#34;: f&#34;{self.forum_url}/{self.api_endpoint}/discussions&#34;,
            &#34;posts&#34;: f&#34;{self.forum_url}/{self.api_endpoint}/posts&#34;,

            &#34;users&#34;: f&#34;{self.forum_url}/{self.api_endpoint}/users&#34;,
            &#34;notifications&#34;: f&#34;{self.forum_url}/{self.api_endpoint}/notifications&#34;,
            &#34;groups&#34;: f&#34;{self.forum_url}/{self.api_endpoint}/groups&#34;,

            &#34;tags&#34;: f&#34;{self.forum_url}/{self.api_endpoint}/tags&#34;,
        }



class FlarumUser(FlarumSession, dict):
    def __init__(self, extensions: Optional[list[ExtensionMixin]]=None, **kwargs):
        &#34;&#34;&#34;
            ### Parameters:
            - `forum_url` - the forum URL that you want the bot to fetch/update data from. This mustn&#39;t end with trailing slash (e. g.: https://domain.tld/ - wrong; https://domain.tld - correct).
            - `username_or_email` - optional. The username or E-mail address to log into. If `None`, then the bot doesn&#39;t login.
            - `password` - optional. The user&#39;s password. If `None`, then the bot doesn&#39;t login.
            - `api_endpoint` - the API endpoint of the forum, without slashes. This can be specified in Flarum&#39;s `config.php` and normally forums don&#39;t need to change the default `&#39;api&#39;`
            - `user_agent` - the user agent that will be used to make all requests. Defaults to `pyflarum &lt;version&gt;`.
            - `session_object` - the `Session` object to make requests with. You can pass any object that supports all operations from the [requests](https://pypi.org/project/requests/) library, check [requests_cache](https://pypi.org/project/requests-cache/) as an example.
            - `extensions` - a list of `ExtensionMixin` classes. These are monkey-patched on initialization. Learn more about [extensions](https://cwkevo.github.io/pyflarum/docs/#extensions).
            ```
        &#34;&#34;&#34;

        self.extensions = extensions

        if self.extensions:
            for extension in self.extensions:
                dependencies = extension.get_dependencies(extension) # type: dict

                hard = dependencies.get(&#34;hard&#34;, None)
                soft = dependencies.get(&#34;soft&#34;, None)

                if hard and len(hard) &gt; 0:
                    for hard_dependency in hard:
                        if hard_dependency not in self.extensions:
                            raise MissingExtensionError(f&#39;`{extension}` hardly depends on `{hard_dependency}`. Please, include that extension too in your extension list.&#39;)

                extension.mixin(extension)

                if soft and len(soft) &gt; 0:
                    for soft_dependency in soft:
                        if soft_dependency not in self.extensions:
                            warnings.warn(f&#39;`{extension}` softly depends on `{soft_dependency}`. Some features might be unavailable.&#39;, MissingExtensionWarning)


        super().__init__(**kwargs)
        __json = self._fetch_user_data()


        if __json:
            self.data = MyUser(user=self, _fetched_data=dict(data=__json))
            self.username = self.data.username

        else:
            self.username = self.username_or_email


    def _fetch_user_data(self) -&gt; Optional[dict]:
        &#34;&#34;&#34;
            Fetches your user&#39;s JSON data.
        &#34;&#34;&#34;

        if self.username_or_email:
            filter = Filter(limit=1)

            if &#39;@&#39; in self.username_or_email:
                filter.query = f&#39;email:{self.username_or_email}&#39;

            else:
                filter.query = self.username_or_email


            raw = self.session.get(f&#34;{self.api_urls[&#39;users&#39;]}&#34;, params=filter.to_dict)
            json = parse_request(raw)

            for possible_user in json.get(&#34;data&#34;, [{}]):
                if &#39;@&#39; in self.username_or_email:
                    if possible_user.get(&#34;attributes&#34;, {}).get(&#34;email&#34;, None) == self.username_or_email:
                        return possible_user

                else:
                    if possible_user.get(&#34;attributes&#34;, {}).get(&#34;username&#34;, None) == self.username_or_email:
                        return possible_user


        return None


    def _update_user_data(self, new_data: dict) -&gt; &#39;FlarumUser | User&#39;:
        &#34;&#34;&#34;
            Updates your user data with new data, if the data belongs to you.
            Then returns updated `FlarumUser`.

            If the data doesn&#39;t belong to you, the other `User` is returned.
        &#34;&#34;&#34;

        if int(new_data.get(&#34;data&#34;, {}).get(&#34;id&#34;, -1)) == self.data.id:
            self.data = MyUser(user=self, _fetched_data=new_data)

            return self


        else:
            user = User(user=self, _fetched_data=new_data)

            return user



    def get_forum_data(self) -&gt; Forum:
        &#34;&#34;&#34;
            Obtains the forum data, returns `Forum` object.
        &#34;&#34;&#34;

        raw = self.session.get(f&#34;{self.api_urls[&#39;base&#39;]}&#34;)
        json = parse_request(raw)


        return Forum(user=self, _fetched_data=json)


    def get_user_by_id(self, id: int) -&gt; User:
        &#34;&#34;&#34;
            Obtains a user by specific ID.
        &#34;&#34;&#34;

        raw = self.session.get(f&#34;{self.api_urls[&#39;users&#39;]}/{id}&#34;)
        json = parse_request(raw)


        return User(user=self, _fetched_data=json)


    def get_discussion_by_id(self, id: int) -&gt; Discussion:
        &#34;&#34;&#34;
            Obtains a discussion by specific ID.
        &#34;&#34;&#34;

        raw = self.session.get(f&#34;{self.api_urls[&#39;discussions&#39;]}/{id}&#34;)
        json = parse_request(raw)


        return Discussion(user=self, _fetched_data=json)


    def get_post_by_id(self, id: int) -&gt; Post:
        &#34;&#34;&#34;
            Obtains a post by specific ID.
        &#34;&#34;&#34;

        raw = self.session.get(f&#34;{self.api_urls[&#39;posts&#39;]}/{id}&#34;)
        json = parse_request(raw)


        return Post(user=self, _fetched_data=json)


    def get_discussions(self, filter: Optional[Filter]=None) -&gt; Discussions:
        &#34;&#34;&#34;
            Obtains all discussions from `/api/discussions`, optionally filtering results by using `filter`.
        &#34;&#34;&#34;

        if filter:
            raw = self.session.get(f&#34;{self.api_urls[&#39;discussions&#39;]}&#34;, params=filter.to_dict)

        else:
            raw = self.session.get(f&#34;{self.api_urls[&#39;discussions&#39;]}&#34;)

        json = parse_request(raw)


        return Discussions(user=self, _fetched_data=json)


    def get_posts(self, filter: Optional[Filter]=None):
        &#34;&#34;&#34;
            Obtains all posts from `/api/posts`, optionally filtering results by using `filter`.
        &#34;&#34;&#34;

        if filter:
            raw = self.session.get(f&#34;{self.api_urls[&#39;posts&#39;]}&#34;, params=filter.to_dict)

        else:
            raw = self.session.get(f&#34;{self.api_urls[&#39;posts&#39;]}&#34;)

        json = parse_request(raw)


        return Posts(user=self, _fetched_data=json)


    def get_users(self, filter: Filter=None) -&gt; Users:
        &#34;&#34;&#34;
            Obtains all users from `/api/users`, optionally filtering results by using `filter`.
        &#34;&#34;&#34;


        if filter:
            raw = self.session.get(f&#34;{self.api_urls[&#39;users&#39;]}&#34;, params=filter.to_dict)

        else:
            raw = self.session.get(f&#34;{self.api_urls[&#39;users&#39;]}&#34;)

        json = parse_request(raw)


        return Users(user=self, _fetched_data=json)


    def get_notifications(self, filter: Optional[Filter]=None) -&gt; Notifications:
        &#34;&#34;&#34;
            Obtains all of your notifications from `/api/notifications`, optionally filtering results by using `filter`.
        &#34;&#34;&#34;

        if filter:
            raw = self.session.get(f&#34;{self.api_urls[&#39;notifications&#39;]}&#34;, params=filter.to_dict)
        
        else:
            raw = self.session.get(f&#34;{self.api_urls[&#39;notifications&#39;]}&#34;)


        json = parse_request(raw)


        return Notifications(user=self, _fetched_data=json)


    def mark_all_discussions_as_read(self, at: datetime=datetime.now()) -&gt; Literal[True]:
        &#34;&#34;&#34;
            Marks all discussions as read.

            Specify `at` to mark discussions as read at a specific date (strange how this is allowed, might be
            because of timezones).
        &#34;&#34;&#34;

        post_data = {
            &#34;data&#34;: {
                &#34;type&#34;: &#34;users&#34;,
                &#34;id&#34;: self.data.id,
                &#34;attributes&#34;: {
                    &#34;markedAllAsReadAt&#34;: datetime_to_flarum(at)
                }
            }
        }

        raw = self.session.patch(f&#34;{self.api_urls[&#39;users&#39;]}/{self.data.id}&#34;, json=post_data)
        parse_request(raw)


        return True


    def mark_all_notifications_as_read(self) -&gt; Literal[True]:
        &#34;&#34;&#34;
            Marks all notifications as read. Returns `True` when successful.
        &#34;&#34;&#34;

        raw = self.session.post(f&#34;{self.api_urls[&#39;notifications&#39;]}/read&#34;)
        parse_request(raw)


        return True


    def get_groups(self) -&gt; Groups:
        &#34;&#34;&#34;
            Obtains all groups of a forum from `/api/groups`.
        &#34;&#34;&#34;

        raw = self.session.get(f&#34;{self.api_urls[&#39;groups&#39;]}&#34;)
        json = parse_request(raw)


        return Groups(user=self, _fetched_data=json)


    def update_user_info(self, user: Optional[&#39;AnyUser&#39;]=None, new_username: Optional[str]=None, groups: Optional[&#39;list[str | int] | list[Group] | Groups&#39;]=None) -&gt; &#39;FlarumUser | User&#39;:
        &#34;&#34;&#34;
            Updates the info of a user (this can be your user or someone else).

            If you are updating yourself, then `FlarumUser` is returned (with the new data).
            If you are updating someone else, then the updated `User` is returned.

            ### Parameters:
            - `user` - the user to update.
            - `new_username` - the user&#39;s new username.
            - `groups` - new groups of the user. This can either be a list of `pyflarum.flarum.core.groups.Group` objects,
            or just one `pyflarum.flarum.core.groups.Groups`, or a list of `str` or `int` representing the group IDs.
        &#34;&#34;&#34;

        id = user.id if user else self.data.id

        patch_data = {
            &#34;data&#34;: {
                &#34;type&#34;: &#34;users&#34;,
                &#34;id&#34;: id,
                &#34;attributes&#34;: {},
                &#34;relationships&#34;: {}
            }
        } # type: dict[str, dict[str, dict]]


        if new_username:
            patch_data[&#39;attributes&#39;][&#39;username&#39;] = new_username

        if groups:
            patch_data[&#39;data&#39;][&#39;relationships&#39;].update({&#34;groups&#34;: {&#34;data&#34;: [group.id if isinstance(group, Group) else group for group in groups]}})


        raw = self.session.patch(f&#34;{self.api_urls[&#39;users&#39;]}/{id}&#34;, json=patch_data)
        json = parse_request(raw)


        return self._update_user_data(new_data=json)


    def send_password_reset_email(self) -&gt; &#39;FlarumUser | User&#39;:
        &#34;&#34;&#34;
            Allows you to send yourself a password reset E-mail.
        &#34;&#34;&#34;

        patch_data = {&#34;email&#34;: self.data.email}

        raw = self.session.patch(f&#34;{self.api_urls[&#39;users&#39;]}/{self.data.id}&#34;, json=patch_data)
        json = parse_request(raw)


        return self._update_user_data(new_data=dict(data=json))


    def update_preferences(self, preferences: Iterable[tuple[str, Any]], user: Optional[&#39;AnyUser&#39;]=None) -&gt; &#39;FlarumUser | User&#39;:
        &#34;&#34;&#34;
            Updates an user&#39;s preferences.

            If no user is specified, then your user is updated.
        &#34;&#34;&#34;

        id = user.id if user else self.data.id

        patch_data = {
            &#34;data&#34;: {
                &#34;type&#34;: &#34;users&#34;,
                &#34;id&#34;: id,
                &#34;attributes&#34;: {
                    &#34;preferences&#34;: {}
                }
            }
        }


        for preference, value in preferences:
            patch_data[&#39;data&#39;][&#39;attributes&#39;][&#39;preferences&#39;][preference] = value


        raw = self.session.patch(f&#34;{self.api_urls[&#39;users&#39;]}/{id}&#34;, json=patch_data)
        json = parse_request(raw)


        return self._update_user_data(new_data=json)


    def change_email(self, new_email: str, password_confirmation: str, user: Optional[&#39;AnyUser&#39;]=None) -&gt; &#39;FlarumUser | User&#39;:
        &#34;&#34;&#34;
            Changes your E-mail. If `user` is specified, then that user&#39;s E-mail is changed.

            If you are changing the E-mail of another user, you do not need to specify their password.
        &#34;&#34;&#34;

        id = user.id if user else self.data.id

        patch_data = {
            &#34;data&#34;: {
                &#34;type&#34;: &#34;users&#34;,
                &#34;id&#34;: id,
                &#34;attributes&#34;: {
                    &#34;email&#34;: new_email
                }
            },
            &#34;meta&#34;: {
                &#34;password&#34;: password_confirmation
            }
        }

        raw = self.session.patch(f&#34;{self.api_urls[&#39;users&#39;]}/{id}&#34;, json=patch_data)
        json = parse_request(raw)


        return self._update_user_data(new_data=json)


    def upload_user_avatar(self, file: BinaryIO, user: Optional[&#39;AnyUser&#39;]=None, file_name: str=&#34;avatar&#34;, file_type: Literal[&#39;image/png&#39;, &#39;image/jpeg&#39;, &#39;image/gif&#39;]=&#34;image/png&#34;) -&gt; &#39;FlarumUser | User&#39;:
        &#34;&#34;&#34;
            Uploads an avatar for yourself. If `user` is specified, then avatar of that user is changed.
        &#34;&#34;&#34;

        id = user.id if user else self.data.id

        raw = self.session.post(url=f&#34;{self.api_urls[&#39;users&#39;]}/{id}/avatar&#34;, files={ &#34;avatar&#34;: (file_name, file, file_type) })
        json = parse_request(raw)


        return self._update_user_data(new_data=json)


    def remove_user_avatar(self, user: Optional[&#39;AnyUser&#39;]=None) -&gt; &#39;FlarumUser | User&#39;:
        &#34;&#34;&#34;
            Removes your user&#39;s avatar. If `user` is specified, then avatar of that user is removed.
        &#34;&#34;&#34;

        raw = self.session.delete(url=f&#34;{self.api_urls[&#39;users&#39;]}/{user.id if user else self.data.id}/avatar&#34;)
        json = parse_request(raw)
 

        return self._update_user_data(new_data=json)</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="pyflarum.session.FlarumSession"><code class="flex name class">
<span>class <span class="ident">FlarumSession</span></span>
<span>(</span><span>forum_url: str, username_or_email: Optional[str] = None, password: Optional[str] = None, api_endpoint: str = 'api', user_agent: str = 'pyflarum', session_object: Session | Any = &lt;requests.sessions.Session object&gt;)</span>
</code></dt>
<dd>
<div class="desc"><p>The main object that carries the Flarum session.</p>
<h3 id="parameters">Parameters:</h3>
<ul>
<li><code>forum_url</code> - the forum URL that you want the bot to fetch/update data from.</li>
<li><code>username_or_email</code> - optional. The username or E-mail address to log into. If <code>None</code>, then the user isn't logged in.</li>
<li><code>password</code> - optional. The user's password. If <code>None</code>, then the user isn't logged in.</li>
<li><code>api_endpoint</code> - the API endpoint of the forum, without slashes. This can be specified in Flarum's <code>config.php</code> and normally forums don't need to change the default <code>'api'</code></li>
<li><code>user_agent</code> - the user agent that will be used to make all requests. Defaults to <code>'pyflarum'</code>.</li>
<li><code>session_object</code> - the <code>Session</code> object to make requests with. You can pass any object that supports all operations from the <a href="https://pypi.org/project/requests/">requests</a> library, check <a href="https://pypi.org/project/requests-cache/">requests_cache</a> as an example.
```</li>
</ul></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/CWKevo/pyFlarum/blob/a65fc09d5ae7d6cb04d63d7abe39aabe0cf03c52/pyflarum\session.py#L36-L140" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class FlarumSession:
    &#34;&#34;&#34;
        The main object that carries the Flarum session.
    &#34;&#34;&#34;

    def __init__(self, forum_url: str, username_or_email: Optional[str]=None, password: Optional[str]=None, api_endpoint: str=&#34;api&#34;, user_agent: str=&#39;pyflarum&#39;, session_object: &#39;Session | Any&#39;=Session()):
        &#34;&#34;&#34;
            ### Parameters:
            - `forum_url` - the forum URL that you want the bot to fetch/update data from.
            - `username_or_email` - optional. The username or E-mail address to log into. If `None`, then the user isn&#39;t logged in.
            - `password` - optional. The user&#39;s password. If `None`, then the user isn&#39;t logged in.
            - `api_endpoint` - the API endpoint of the forum, without slashes. This can be specified in Flarum&#39;s `config.php` and normally forums don&#39;t need to change the default `&#39;api&#39;`
            - `user_agent` - the user agent that will be used to make all requests. Defaults to `&#39;pyflarum&#39;`.
            - `session_object` - the `Session` object to make requests with. You can pass any object that supports all operations from the [requests](https://pypi.org/project/requests/) library, check [requests_cache](https://pypi.org/project/requests-cache/) as an example.
            ```
        &#34;&#34;&#34;

        if not forum_url.startswith(&#34;http&#34;):
            raise TypeError(f&#39;Invalid protocol used in `forum_url` ({forum_url}) - expected either &#34;https://&#34; or &#34;http://&#34;&#39;)

        parsed_url = urlparse(forum_url, scheme=&#34;https&#34;)
        self.forum_url = f&#34;{parsed_url.scheme}://{parsed_url.hostname}&#34;

        self.api_endpoint = api_endpoint
        self.username_or_email = username_or_email
        self.session = session_object

        self.session.headers.update({
            &#34;User-Agent&#34;: user_agent
        })


        self.authenticate(username_or_email, password)


    def __str__(self) -&gt; str:
        return f&#39;&lt;{type(self).__name__}&gt; authenticated={self.is_authenticated}; username={self.username_or_email}&#39;


    def __repr__(self) -&gt; str:
        return self.__str__()


    def authenticate(self, username_or_email: Optional[str]=None, password: Optional[str]=None) -&gt; None:
        &#34;&#34;&#34;
            Authenticates your user. This can be run after `FlarumUser` was initialized, to switch to a different user. You can even change
            `FlarumUser.forum_url` to login to another forum.

            ### Parameters:
            - `username_or_email` - optional. The username or E-mail address to log into. If `None`, then the user isn&#39;t logged in.
            - `password` - optional. The user&#39;s password. If `None`, then the user isn&#39;t logged in.
        &#34;&#34;&#34;

        if username_or_email and password:
            identification_data = {&#34;identification&#34;: username_or_email, &#34;password&#34;: password}

            raw = self.session.post(url=f&#39;{self.forum_url}/api/token&#39;, json=identification_data)
            token_data = parse_request(raw)

            token = token_data.get(&#34;token&#34;, None)
            user_id = token_data.get(&#34;userId&#34;, None)

            if token:
                self.session.headers.update({
                    &#34;Authorization&#34;: f&#39;Token {token}; userId={user_id}&#39;,
                })

                self.is_authenticated = True

            else:
                self.is_authenticated = False

        else:
            self.session.headers.update({
                &#34;Authorization&#34;: None,
            })

            self.is_authenticated = False


    @property
    def api_urls(self) -&gt; dict[str, str]:
        &#34;&#34;&#34;
            Simple, hardcoded `&#39;key: value&#39;` `dict` of Flarum&#39;s API routes for quick access.

            API routes reference (old):
            https://github.com/flarum/flarum.github.io/blob/20322c0e6011e4f304ae7e95f41594a0b086bc27/_docs/api.md
        &#34;&#34;&#34;

        return {
            &#34;base&#34;: f&#34;{self.forum_url}/{self.api_endpoint}&#34;,
            &#34;forum&#34;: f&#34;{self.forum_url}/{self.api_endpoint}/forum&#34;,

            &#34;settings&#34;: f&#34;{self.forum_url}/{self.api_endpoint}/settings&#34;,
            &#34;extensions&#34;: f&#34;{self.forum_url}/{self.api_endpoint}/extensions&#34;,

            &#34;discussions&#34;: f&#34;{self.forum_url}/{self.api_endpoint}/discussions&#34;,
            &#34;posts&#34;: f&#34;{self.forum_url}/{self.api_endpoint}/posts&#34;,

            &#34;users&#34;: f&#34;{self.forum_url}/{self.api_endpoint}/users&#34;,
            &#34;notifications&#34;: f&#34;{self.forum_url}/{self.api_endpoint}/notifications&#34;,
            &#34;groups&#34;: f&#34;{self.forum_url}/{self.api_endpoint}/groups&#34;,

            &#34;tags&#34;: f&#34;{self.forum_url}/{self.api_endpoint}/tags&#34;,
        }</code></pre>
</details>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="pyflarum.session.FlarumUser" href="#pyflarum.session.FlarumUser">FlarumUser</a></li>
</ul>
<h3>Instance variables</h3>
<dl>
<dt id="pyflarum.session.FlarumSession.api_urls"><code class="name">var <span class="ident">api_urls</span> : dict</code></dt>
<dd>
<div class="desc"><p>Simple, hardcoded <code>'key: value'</code> <code>dict</code> of Flarum's API routes for quick access.</p>
<p>API routes reference (old):
<a href="https://github.com/flarum/flarum.github.io/blob/20322c0e6011e4f304ae7e95f41594a0b086bc27/_docs/api.md">https://github.com/flarum/flarum.github.io/blob/20322c0e6011e4f304ae7e95f41594a0b086bc27/_docs/api.md</a></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/CWKevo/pyFlarum/blob/a65fc09d5ae7d6cb04d63d7abe39aabe0cf03c52/pyflarum\session.py#L116-L140" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@property
def api_urls(self) -&gt; dict[str, str]:
    &#34;&#34;&#34;
        Simple, hardcoded `&#39;key: value&#39;` `dict` of Flarum&#39;s API routes for quick access.

        API routes reference (old):
        https://github.com/flarum/flarum.github.io/blob/20322c0e6011e4f304ae7e95f41594a0b086bc27/_docs/api.md
    &#34;&#34;&#34;

    return {
        &#34;base&#34;: f&#34;{self.forum_url}/{self.api_endpoint}&#34;,
        &#34;forum&#34;: f&#34;{self.forum_url}/{self.api_endpoint}/forum&#34;,

        &#34;settings&#34;: f&#34;{self.forum_url}/{self.api_endpoint}/settings&#34;,
        &#34;extensions&#34;: f&#34;{self.forum_url}/{self.api_endpoint}/extensions&#34;,

        &#34;discussions&#34;: f&#34;{self.forum_url}/{self.api_endpoint}/discussions&#34;,
        &#34;posts&#34;: f&#34;{self.forum_url}/{self.api_endpoint}/posts&#34;,

        &#34;users&#34;: f&#34;{self.forum_url}/{self.api_endpoint}/users&#34;,
        &#34;notifications&#34;: f&#34;{self.forum_url}/{self.api_endpoint}/notifications&#34;,
        &#34;groups&#34;: f&#34;{self.forum_url}/{self.api_endpoint}/groups&#34;,

        &#34;tags&#34;: f&#34;{self.forum_url}/{self.api_endpoint}/tags&#34;,
    }</code></pre>
</details>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="pyflarum.session.FlarumSession.authenticate"><code class="name flex">
<span>def <span class="ident">authenticate</span></span>(<span>self, username_or_email: Optional[str] = None, password: Optional[str] = None) ‑> NoneType</span>
</code></dt>
<dd>
<div class="desc"><p>Authenticates your user. This can be run after <code><a title="pyflarum.session.FlarumUser" href="#pyflarum.session.FlarumUser">FlarumUser</a></code> was initialized, to switch to a different user. You can even change
<code>FlarumUser.forum_url</code> to login to another forum.</p>
<h3 id="parameters">Parameters:</h3>
<ul>
<li><code>username_or_email</code> - optional. The username or E-mail address to log into. If <code>None</code>, then the user isn't logged in.</li>
<li><code>password</code> - optional. The user's password. If <code>None</code>, then the user isn't logged in.</li>
</ul></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/CWKevo/pyFlarum/blob/a65fc09d5ae7d6cb04d63d7abe39aabe0cf03c52/pyflarum\session.py#L79-L113" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def authenticate(self, username_or_email: Optional[str]=None, password: Optional[str]=None) -&gt; None:
    &#34;&#34;&#34;
        Authenticates your user. This can be run after `FlarumUser` was initialized, to switch to a different user. You can even change
        `FlarumUser.forum_url` to login to another forum.

        ### Parameters:
        - `username_or_email` - optional. The username or E-mail address to log into. If `None`, then the user isn&#39;t logged in.
        - `password` - optional. The user&#39;s password. If `None`, then the user isn&#39;t logged in.
    &#34;&#34;&#34;

    if username_or_email and password:
        identification_data = {&#34;identification&#34;: username_or_email, &#34;password&#34;: password}

        raw = self.session.post(url=f&#39;{self.forum_url}/api/token&#39;, json=identification_data)
        token_data = parse_request(raw)

        token = token_data.get(&#34;token&#34;, None)
        user_id = token_data.get(&#34;userId&#34;, None)

        if token:
            self.session.headers.update({
                &#34;Authorization&#34;: f&#39;Token {token}; userId={user_id}&#39;,
            })

            self.is_authenticated = True

        else:
            self.is_authenticated = False

    else:
        self.session.headers.update({
            &#34;Authorization&#34;: None,
        })

        self.is_authenticated = False</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="pyflarum.session.FlarumUser"><code class="flex name class">
<span>class <span class="ident">FlarumUser</span></span>
<span>(</span><span>extensions: Optional[list[<a title="pyflarum.extensions.ExtensionMixin" href="extensions/index.html#pyflarum.extensions.ExtensionMixin">ExtensionMixin</a>]] = None, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>The main object that carries the Flarum session.</p>
<h3 id="parameters">Parameters:</h3>
<ul>
<li><code>forum_url</code> - the forum URL that you want the bot to fetch/update data from. This mustn't end with trailing slash (e. g.: <a href="https://domain.tld/">https://domain.tld/</a> - wrong; <a href="https://domain.tld">https://domain.tld</a> - correct).</li>
<li><code>username_or_email</code> - optional. The username or E-mail address to log into. If <code>None</code>, then the bot doesn't login.</li>
<li><code>password</code> - optional. The user's password. If <code>None</code>, then the bot doesn't login.</li>
<li><code>api_endpoint</code> - the API endpoint of the forum, without slashes. This can be specified in Flarum's <code>config.php</code> and normally forums don't need to change the default <code>'api'</code></li>
<li><code>user_agent</code> - the user agent that will be used to make all requests. Defaults to <code>pyflarum &lt;version&gt;</code>.</li>
<li><code>session_object</code> - the <code>Session</code> object to make requests with. You can pass any object that supports all operations from the <a href="https://pypi.org/project/requests/">requests</a> library, check <a href="https://pypi.org/project/requests-cache/">requests_cache</a> as an example.</li>
<li><code>extensions</code> - a list of <code>ExtensionMixin</code> classes. These are monkey-patched on initialization. Learn more about <a href="https://cwkevo.github.io/pyflarum/docs/#extensions">extensions</a>.
```</li>
</ul></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/CWKevo/pyFlarum/blob/a65fc09d5ae7d6cb04d63d7abe39aabe0cf03c52/pyflarum\session.py#L144-L548" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class FlarumUser(FlarumSession, dict):
    def __init__(self, extensions: Optional[list[ExtensionMixin]]=None, **kwargs):
        &#34;&#34;&#34;
            ### Parameters:
            - `forum_url` - the forum URL that you want the bot to fetch/update data from. This mustn&#39;t end with trailing slash (e. g.: https://domain.tld/ - wrong; https://domain.tld - correct).
            - `username_or_email` - optional. The username or E-mail address to log into. If `None`, then the bot doesn&#39;t login.
            - `password` - optional. The user&#39;s password. If `None`, then the bot doesn&#39;t login.
            - `api_endpoint` - the API endpoint of the forum, without slashes. This can be specified in Flarum&#39;s `config.php` and normally forums don&#39;t need to change the default `&#39;api&#39;`
            - `user_agent` - the user agent that will be used to make all requests. Defaults to `pyflarum &lt;version&gt;`.
            - `session_object` - the `Session` object to make requests with. You can pass any object that supports all operations from the [requests](https://pypi.org/project/requests/) library, check [requests_cache](https://pypi.org/project/requests-cache/) as an example.
            - `extensions` - a list of `ExtensionMixin` classes. These are monkey-patched on initialization. Learn more about [extensions](https://cwkevo.github.io/pyflarum/docs/#extensions).
            ```
        &#34;&#34;&#34;

        self.extensions = extensions

        if self.extensions:
            for extension in self.extensions:
                dependencies = extension.get_dependencies(extension) # type: dict

                hard = dependencies.get(&#34;hard&#34;, None)
                soft = dependencies.get(&#34;soft&#34;, None)

                if hard and len(hard) &gt; 0:
                    for hard_dependency in hard:
                        if hard_dependency not in self.extensions:
                            raise MissingExtensionError(f&#39;`{extension}` hardly depends on `{hard_dependency}`. Please, include that extension too in your extension list.&#39;)

                extension.mixin(extension)

                if soft and len(soft) &gt; 0:
                    for soft_dependency in soft:
                        if soft_dependency not in self.extensions:
                            warnings.warn(f&#39;`{extension}` softly depends on `{soft_dependency}`. Some features might be unavailable.&#39;, MissingExtensionWarning)


        super().__init__(**kwargs)
        __json = self._fetch_user_data()


        if __json:
            self.data = MyUser(user=self, _fetched_data=dict(data=__json))
            self.username = self.data.username

        else:
            self.username = self.username_or_email


    def _fetch_user_data(self) -&gt; Optional[dict]:
        &#34;&#34;&#34;
            Fetches your user&#39;s JSON data.
        &#34;&#34;&#34;

        if self.username_or_email:
            filter = Filter(limit=1)

            if &#39;@&#39; in self.username_or_email:
                filter.query = f&#39;email:{self.username_or_email}&#39;

            else:
                filter.query = self.username_or_email


            raw = self.session.get(f&#34;{self.api_urls[&#39;users&#39;]}&#34;, params=filter.to_dict)
            json = parse_request(raw)

            for possible_user in json.get(&#34;data&#34;, [{}]):
                if &#39;@&#39; in self.username_or_email:
                    if possible_user.get(&#34;attributes&#34;, {}).get(&#34;email&#34;, None) == self.username_or_email:
                        return possible_user

                else:
                    if possible_user.get(&#34;attributes&#34;, {}).get(&#34;username&#34;, None) == self.username_or_email:
                        return possible_user


        return None


    def _update_user_data(self, new_data: dict) -&gt; &#39;FlarumUser | User&#39;:
        &#34;&#34;&#34;
            Updates your user data with new data, if the data belongs to you.
            Then returns updated `FlarumUser`.

            If the data doesn&#39;t belong to you, the other `User` is returned.
        &#34;&#34;&#34;

        if int(new_data.get(&#34;data&#34;, {}).get(&#34;id&#34;, -1)) == self.data.id:
            self.data = MyUser(user=self, _fetched_data=new_data)

            return self


        else:
            user = User(user=self, _fetched_data=new_data)

            return user



    def get_forum_data(self) -&gt; Forum:
        &#34;&#34;&#34;
            Obtains the forum data, returns `Forum` object.
        &#34;&#34;&#34;

        raw = self.session.get(f&#34;{self.api_urls[&#39;base&#39;]}&#34;)
        json = parse_request(raw)


        return Forum(user=self, _fetched_data=json)


    def get_user_by_id(self, id: int) -&gt; User:
        &#34;&#34;&#34;
            Obtains a user by specific ID.
        &#34;&#34;&#34;

        raw = self.session.get(f&#34;{self.api_urls[&#39;users&#39;]}/{id}&#34;)
        json = parse_request(raw)


        return User(user=self, _fetched_data=json)


    def get_discussion_by_id(self, id: int) -&gt; Discussion:
        &#34;&#34;&#34;
            Obtains a discussion by specific ID.
        &#34;&#34;&#34;

        raw = self.session.get(f&#34;{self.api_urls[&#39;discussions&#39;]}/{id}&#34;)
        json = parse_request(raw)


        return Discussion(user=self, _fetched_data=json)


    def get_post_by_id(self, id: int) -&gt; Post:
        &#34;&#34;&#34;
            Obtains a post by specific ID.
        &#34;&#34;&#34;

        raw = self.session.get(f&#34;{self.api_urls[&#39;posts&#39;]}/{id}&#34;)
        json = parse_request(raw)


        return Post(user=self, _fetched_data=json)


    def get_discussions(self, filter: Optional[Filter]=None) -&gt; Discussions:
        &#34;&#34;&#34;
            Obtains all discussions from `/api/discussions`, optionally filtering results by using `filter`.
        &#34;&#34;&#34;

        if filter:
            raw = self.session.get(f&#34;{self.api_urls[&#39;discussions&#39;]}&#34;, params=filter.to_dict)

        else:
            raw = self.session.get(f&#34;{self.api_urls[&#39;discussions&#39;]}&#34;)

        json = parse_request(raw)


        return Discussions(user=self, _fetched_data=json)


    def get_posts(self, filter: Optional[Filter]=None):
        &#34;&#34;&#34;
            Obtains all posts from `/api/posts`, optionally filtering results by using `filter`.
        &#34;&#34;&#34;

        if filter:
            raw = self.session.get(f&#34;{self.api_urls[&#39;posts&#39;]}&#34;, params=filter.to_dict)

        else:
            raw = self.session.get(f&#34;{self.api_urls[&#39;posts&#39;]}&#34;)

        json = parse_request(raw)


        return Posts(user=self, _fetched_data=json)


    def get_users(self, filter: Filter=None) -&gt; Users:
        &#34;&#34;&#34;
            Obtains all users from `/api/users`, optionally filtering results by using `filter`.
        &#34;&#34;&#34;


        if filter:
            raw = self.session.get(f&#34;{self.api_urls[&#39;users&#39;]}&#34;, params=filter.to_dict)

        else:
            raw = self.session.get(f&#34;{self.api_urls[&#39;users&#39;]}&#34;)

        json = parse_request(raw)


        return Users(user=self, _fetched_data=json)


    def get_notifications(self, filter: Optional[Filter]=None) -&gt; Notifications:
        &#34;&#34;&#34;
            Obtains all of your notifications from `/api/notifications`, optionally filtering results by using `filter`.
        &#34;&#34;&#34;

        if filter:
            raw = self.session.get(f&#34;{self.api_urls[&#39;notifications&#39;]}&#34;, params=filter.to_dict)
        
        else:
            raw = self.session.get(f&#34;{self.api_urls[&#39;notifications&#39;]}&#34;)


        json = parse_request(raw)


        return Notifications(user=self, _fetched_data=json)


    def mark_all_discussions_as_read(self, at: datetime=datetime.now()) -&gt; Literal[True]:
        &#34;&#34;&#34;
            Marks all discussions as read.

            Specify `at` to mark discussions as read at a specific date (strange how this is allowed, might be
            because of timezones).
        &#34;&#34;&#34;

        post_data = {
            &#34;data&#34;: {
                &#34;type&#34;: &#34;users&#34;,
                &#34;id&#34;: self.data.id,
                &#34;attributes&#34;: {
                    &#34;markedAllAsReadAt&#34;: datetime_to_flarum(at)
                }
            }
        }

        raw = self.session.patch(f&#34;{self.api_urls[&#39;users&#39;]}/{self.data.id}&#34;, json=post_data)
        parse_request(raw)


        return True


    def mark_all_notifications_as_read(self) -&gt; Literal[True]:
        &#34;&#34;&#34;
            Marks all notifications as read. Returns `True` when successful.
        &#34;&#34;&#34;

        raw = self.session.post(f&#34;{self.api_urls[&#39;notifications&#39;]}/read&#34;)
        parse_request(raw)


        return True


    def get_groups(self) -&gt; Groups:
        &#34;&#34;&#34;
            Obtains all groups of a forum from `/api/groups`.
        &#34;&#34;&#34;

        raw = self.session.get(f&#34;{self.api_urls[&#39;groups&#39;]}&#34;)
        json = parse_request(raw)


        return Groups(user=self, _fetched_data=json)


    def update_user_info(self, user: Optional[&#39;AnyUser&#39;]=None, new_username: Optional[str]=None, groups: Optional[&#39;list[str | int] | list[Group] | Groups&#39;]=None) -&gt; &#39;FlarumUser | User&#39;:
        &#34;&#34;&#34;
            Updates the info of a user (this can be your user or someone else).

            If you are updating yourself, then `FlarumUser` is returned (with the new data).
            If you are updating someone else, then the updated `User` is returned.

            ### Parameters:
            - `user` - the user to update.
            - `new_username` - the user&#39;s new username.
            - `groups` - new groups of the user. This can either be a list of `pyflarum.flarum.core.groups.Group` objects,
            or just one `pyflarum.flarum.core.groups.Groups`, or a list of `str` or `int` representing the group IDs.
        &#34;&#34;&#34;

        id = user.id if user else self.data.id

        patch_data = {
            &#34;data&#34;: {
                &#34;type&#34;: &#34;users&#34;,
                &#34;id&#34;: id,
                &#34;attributes&#34;: {},
                &#34;relationships&#34;: {}
            }
        } # type: dict[str, dict[str, dict]]


        if new_username:
            patch_data[&#39;attributes&#39;][&#39;username&#39;] = new_username

        if groups:
            patch_data[&#39;data&#39;][&#39;relationships&#39;].update({&#34;groups&#34;: {&#34;data&#34;: [group.id if isinstance(group, Group) else group for group in groups]}})


        raw = self.session.patch(f&#34;{self.api_urls[&#39;users&#39;]}/{id}&#34;, json=patch_data)
        json = parse_request(raw)


        return self._update_user_data(new_data=json)


    def send_password_reset_email(self) -&gt; &#39;FlarumUser | User&#39;:
        &#34;&#34;&#34;
            Allows you to send yourself a password reset E-mail.
        &#34;&#34;&#34;

        patch_data = {&#34;email&#34;: self.data.email}

        raw = self.session.patch(f&#34;{self.api_urls[&#39;users&#39;]}/{self.data.id}&#34;, json=patch_data)
        json = parse_request(raw)


        return self._update_user_data(new_data=dict(data=json))


    def update_preferences(self, preferences: Iterable[tuple[str, Any]], user: Optional[&#39;AnyUser&#39;]=None) -&gt; &#39;FlarumUser | User&#39;:
        &#34;&#34;&#34;
            Updates an user&#39;s preferences.

            If no user is specified, then your user is updated.
        &#34;&#34;&#34;

        id = user.id if user else self.data.id

        patch_data = {
            &#34;data&#34;: {
                &#34;type&#34;: &#34;users&#34;,
                &#34;id&#34;: id,
                &#34;attributes&#34;: {
                    &#34;preferences&#34;: {}
                }
            }
        }


        for preference, value in preferences:
            patch_data[&#39;data&#39;][&#39;attributes&#39;][&#39;preferences&#39;][preference] = value


        raw = self.session.patch(f&#34;{self.api_urls[&#39;users&#39;]}/{id}&#34;, json=patch_data)
        json = parse_request(raw)


        return self._update_user_data(new_data=json)


    def change_email(self, new_email: str, password_confirmation: str, user: Optional[&#39;AnyUser&#39;]=None) -&gt; &#39;FlarumUser | User&#39;:
        &#34;&#34;&#34;
            Changes your E-mail. If `user` is specified, then that user&#39;s E-mail is changed.

            If you are changing the E-mail of another user, you do not need to specify their password.
        &#34;&#34;&#34;

        id = user.id if user else self.data.id

        patch_data = {
            &#34;data&#34;: {
                &#34;type&#34;: &#34;users&#34;,
                &#34;id&#34;: id,
                &#34;attributes&#34;: {
                    &#34;email&#34;: new_email
                }
            },
            &#34;meta&#34;: {
                &#34;password&#34;: password_confirmation
            }
        }

        raw = self.session.patch(f&#34;{self.api_urls[&#39;users&#39;]}/{id}&#34;, json=patch_data)
        json = parse_request(raw)


        return self._update_user_data(new_data=json)


    def upload_user_avatar(self, file: BinaryIO, user: Optional[&#39;AnyUser&#39;]=None, file_name: str=&#34;avatar&#34;, file_type: Literal[&#39;image/png&#39;, &#39;image/jpeg&#39;, &#39;image/gif&#39;]=&#34;image/png&#34;) -&gt; &#39;FlarumUser | User&#39;:
        &#34;&#34;&#34;
            Uploads an avatar for yourself. If `user` is specified, then avatar of that user is changed.
        &#34;&#34;&#34;

        id = user.id if user else self.data.id

        raw = self.session.post(url=f&#34;{self.api_urls[&#39;users&#39;]}/{id}/avatar&#34;, files={ &#34;avatar&#34;: (file_name, file, file_type) })
        json = parse_request(raw)


        return self._update_user_data(new_data=json)


    def remove_user_avatar(self, user: Optional[&#39;AnyUser&#39;]=None) -&gt; &#39;FlarumUser | User&#39;:
        &#34;&#34;&#34;
            Removes your user&#39;s avatar. If `user` is specified, then avatar of that user is removed.
        &#34;&#34;&#34;

        raw = self.session.delete(url=f&#34;{self.api_urls[&#39;users&#39;]}/{user.id if user else self.data.id}/avatar&#34;)
        json = parse_request(raw)
 

        return self._update_user_data(new_data=json)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="pyflarum.session.FlarumSession" href="#pyflarum.session.FlarumSession">FlarumSession</a></li>
<li>builtins.dict</li>
</ul>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="pyflarum.extensions.absolutely_all.AbsolutelyAllFlarumUserMixin" href="extensions/absolutely_all.html#pyflarum.extensions.absolutely_all.AbsolutelyAllFlarumUserMixin">AbsolutelyAllFlarumUserMixin</a></li>
<li><a title="pyflarum.extensions.admin.AdminFlarumUserMixin" href="extensions/admin.html#pyflarum.extensions.admin.AdminFlarumUserMixin">AdminFlarumUserMixin</a></li>
<li><a title="pyflarum.extensions.advanced_search.AdvancedSearchFlarumUserMixin" href="extensions/advanced_search.html#pyflarum.extensions.advanced_search.AdvancedSearchFlarumUserMixin">AdvancedSearchFlarumUserMixin</a></li>
<li><a title="pyflarum.extensions.commands.CommandsFlarumUserMixin" href="extensions/commands.html#pyflarum.extensions.commands.CommandsFlarumUserMixin">CommandsFlarumUserMixin</a></li>
<li><a title="pyflarum.extensions.flarum.FoF_UserBio.UserBioFlarumUserMixin" href="extensions/flarum/FoF_UserBio.html#pyflarum.extensions.flarum.FoF_UserBio.UserBioFlarumUserMixin">UserBioFlarumUserMixin</a></li>
<li><a title="pyflarum.extensions.watch.WatchFlarumUserMixin" href="extensions/watch.html#pyflarum.extensions.watch.WatchFlarumUserMixin">WatchFlarumUserMixin</a></li>
</ul>
<h3>Instance variables</h3>
<dl>
<dt id="pyflarum.session.FlarumUser.api_urls"><code class="name">var <span class="ident">api_urls</span> : dict</code></dt>
<dd>
<p class="inheritance">
<em>Inherited from:</em>
<code><a title="pyflarum.session.FlarumSession" href="#pyflarum.session.FlarumSession">FlarumSession</a></code>.<code><a title="pyflarum.session.FlarumSession.api_urls" href="#pyflarum.session.FlarumSession.api_urls">api_urls</a></code>
</p>
<div class="desc inherited"><p>Simple, hardcoded <code>'key: value'</code> <code>dict</code> of Flarum's API routes for quick access …</p></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="pyflarum.session.FlarumUser.authenticate"><code class="name flex">
<span>def <span class="ident">authenticate</span></span>(<span>self, username_or_email: Optional[str] = None, password: Optional[str] = None) ‑> NoneType</span>
</code></dt>
<dd>
<p class="inheritance">
<em>Inherited from:</em>
<code><a title="pyflarum.session.FlarumSession" href="#pyflarum.session.FlarumSession">FlarumSession</a></code>.<code><a title="pyflarum.session.FlarumSession.authenticate" href="#pyflarum.session.FlarumSession.authenticate">authenticate</a></code>
</p>
<div class="desc inherited"><p>Authenticates your user. This can be run after <code><a title="pyflarum.session.FlarumUser" href="#pyflarum.session.FlarumUser">FlarumUser</a></code> was initialized, to switch to a different user. You can even change
<code>FlarumUser.forum_url</code> …</p></div>
</dd>
<dt id="pyflarum.session.FlarumUser.change_email"><code class="name flex">
<span>def <span class="ident">change_email</span></span>(<span>self, new_email: str, password_confirmation: str, user: Optional[ForwardRef('AnyUser')] = None) ‑> <a title="pyflarum.session.FlarumUser" href="#pyflarum.session.FlarumUser">FlarumUser</a> | User</span>
</code></dt>
<dd>
<div class="desc"><p>Changes your E-mail. If <code>user</code> is specified, then that user's E-mail is changed.</p>
<p>If you are changing the E-mail of another user, you do not need to specify their password.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/CWKevo/pyFlarum/blob/a65fc09d5ae7d6cb04d63d7abe39aabe0cf03c52/pyflarum\session.py#L496-L522" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def change_email(self, new_email: str, password_confirmation: str, user: Optional[&#39;AnyUser&#39;]=None) -&gt; &#39;FlarumUser | User&#39;:
    &#34;&#34;&#34;
        Changes your E-mail. If `user` is specified, then that user&#39;s E-mail is changed.

        If you are changing the E-mail of another user, you do not need to specify their password.
    &#34;&#34;&#34;

    id = user.id if user else self.data.id

    patch_data = {
        &#34;data&#34;: {
            &#34;type&#34;: &#34;users&#34;,
            &#34;id&#34;: id,
            &#34;attributes&#34;: {
                &#34;email&#34;: new_email
            }
        },
        &#34;meta&#34;: {
            &#34;password&#34;: password_confirmation
        }
    }

    raw = self.session.patch(f&#34;{self.api_urls[&#39;users&#39;]}/{id}&#34;, json=patch_data)
    json = parse_request(raw)


    return self._update_user_data(new_data=json)</code></pre>
</details>
</dd>
<dt id="pyflarum.session.FlarumUser.get_discussion_by_id"><code class="name flex">
<span>def <span class="ident">get_discussion_by_id</span></span>(<span>self, id: int) ‑> <a title="pyflarum.flarum.core.discussions.Discussion" href="flarum/core/discussions.html#pyflarum.flarum.core.discussions.Discussion">Discussion</a></span>
</code></dt>
<dd>
<div class="desc"><p>Obtains a discussion by specific ID.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/CWKevo/pyFlarum/blob/a65fc09d5ae7d6cb04d63d7abe39aabe0cf03c52/pyflarum\session.py#L268-L277" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def get_discussion_by_id(self, id: int) -&gt; Discussion:
    &#34;&#34;&#34;
        Obtains a discussion by specific ID.
    &#34;&#34;&#34;

    raw = self.session.get(f&#34;{self.api_urls[&#39;discussions&#39;]}/{id}&#34;)
    json = parse_request(raw)


    return Discussion(user=self, _fetched_data=json)</code></pre>
</details>
</dd>
<dt id="pyflarum.session.FlarumUser.get_discussions"><code class="name flex">
<span>def <span class="ident">get_discussions</span></span>(<span>self, filter: Optional[<a title="pyflarum.flarum.core.filters.Filter" href="flarum/core/filters.html#pyflarum.flarum.core.filters.Filter">Filter</a>] = None) ‑> <a title="pyflarum.flarum.core.discussions.Discussions" href="flarum/core/discussions.html#pyflarum.flarum.core.discussions.Discussions">Discussions</a></span>
</code></dt>
<dd>
<div class="desc"><p>Obtains all discussions from <code>/api/discussions</code>, optionally filtering results by using <code>filter</code>.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/CWKevo/pyFlarum/blob/a65fc09d5ae7d6cb04d63d7abe39aabe0cf03c52/pyflarum\session.py#L292-L306" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def get_discussions(self, filter: Optional[Filter]=None) -&gt; Discussions:
    &#34;&#34;&#34;
        Obtains all discussions from `/api/discussions`, optionally filtering results by using `filter`.
    &#34;&#34;&#34;

    if filter:
        raw = self.session.get(f&#34;{self.api_urls[&#39;discussions&#39;]}&#34;, params=filter.to_dict)

    else:
        raw = self.session.get(f&#34;{self.api_urls[&#39;discussions&#39;]}&#34;)

    json = parse_request(raw)


    return Discussions(user=self, _fetched_data=json)</code></pre>
</details>
</dd>
<dt id="pyflarum.session.FlarumUser.get_forum_data"><code class="name flex">
<span>def <span class="ident">get_forum_data</span></span>(<span>self) ‑> <a title="pyflarum.flarum.core.forum.Forum" href="flarum/core/forum.html#pyflarum.flarum.core.forum.Forum">Forum</a></span>
</code></dt>
<dd>
<div class="desc"><p>Obtains the forum data, returns <code>Forum</code> object.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/CWKevo/pyFlarum/blob/a65fc09d5ae7d6cb04d63d7abe39aabe0cf03c52/pyflarum\session.py#L244-L253" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def get_forum_data(self) -&gt; Forum:
    &#34;&#34;&#34;
        Obtains the forum data, returns `Forum` object.
    &#34;&#34;&#34;

    raw = self.session.get(f&#34;{self.api_urls[&#39;base&#39;]}&#34;)
    json = parse_request(raw)


    return Forum(user=self, _fetched_data=json)</code></pre>
</details>
</dd>
<dt id="pyflarum.session.FlarumUser.get_groups"><code class="name flex">
<span>def <span class="ident">get_groups</span></span>(<span>self) ‑> <a title="pyflarum.flarum.core.groups.Groups" href="flarum/core/groups.html#pyflarum.flarum.core.groups.Groups">Groups</a></span>
</code></dt>
<dd>
<div class="desc"><p>Obtains all groups of a forum from <code>/api/groups</code>.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/CWKevo/pyFlarum/blob/a65fc09d5ae7d6cb04d63d7abe39aabe0cf03c52/pyflarum\session.py#L399-L408" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def get_groups(self) -&gt; Groups:
    &#34;&#34;&#34;
        Obtains all groups of a forum from `/api/groups`.
    &#34;&#34;&#34;

    raw = self.session.get(f&#34;{self.api_urls[&#39;groups&#39;]}&#34;)
    json = parse_request(raw)


    return Groups(user=self, _fetched_data=json)</code></pre>
</details>
</dd>
<dt id="pyflarum.session.FlarumUser.get_notifications"><code class="name flex">
<span>def <span class="ident">get_notifications</span></span>(<span>self, filter: Optional[<a title="pyflarum.flarum.core.filters.Filter" href="flarum/core/filters.html#pyflarum.flarum.core.filters.Filter">Filter</a>] = None) ‑> <a title="pyflarum.flarum.core.notifications.Notifications" href="flarum/core/notifications.html#pyflarum.flarum.core.notifications.Notifications">Notifications</a></span>
</code></dt>
<dd>
<div class="desc"><p>Obtains all of your notifications from <code>/api/notifications</code>, optionally filtering results by using <code>filter</code>.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/CWKevo/pyFlarum/blob/a65fc09d5ae7d6cb04d63d7abe39aabe0cf03c52/pyflarum\session.py#L344-L359" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def get_notifications(self, filter: Optional[Filter]=None) -&gt; Notifications:
    &#34;&#34;&#34;
        Obtains all of your notifications from `/api/notifications`, optionally filtering results by using `filter`.
    &#34;&#34;&#34;

    if filter:
        raw = self.session.get(f&#34;{self.api_urls[&#39;notifications&#39;]}&#34;, params=filter.to_dict)
    
    else:
        raw = self.session.get(f&#34;{self.api_urls[&#39;notifications&#39;]}&#34;)


    json = parse_request(raw)


    return Notifications(user=self, _fetched_data=json)</code></pre>
</details>
</dd>
<dt id="pyflarum.session.FlarumUser.get_post_by_id"><code class="name flex">
<span>def <span class="ident">get_post_by_id</span></span>(<span>self, id: int) ‑> <a title="pyflarum.flarum.core.posts.Post" href="flarum/core/posts.html#pyflarum.flarum.core.posts.Post">Post</a></span>
</code></dt>
<dd>
<div class="desc"><p>Obtains a post by specific ID.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/CWKevo/pyFlarum/blob/a65fc09d5ae7d6cb04d63d7abe39aabe0cf03c52/pyflarum\session.py#L280-L289" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def get_post_by_id(self, id: int) -&gt; Post:
    &#34;&#34;&#34;
        Obtains a post by specific ID.
    &#34;&#34;&#34;

    raw = self.session.get(f&#34;{self.api_urls[&#39;posts&#39;]}/{id}&#34;)
    json = parse_request(raw)


    return Post(user=self, _fetched_data=json)</code></pre>
</details>
</dd>
<dt id="pyflarum.session.FlarumUser.get_posts"><code class="name flex">
<span>def <span class="ident">get_posts</span></span>(<span>self, filter: Optional[<a title="pyflarum.flarum.core.filters.Filter" href="flarum/core/filters.html#pyflarum.flarum.core.filters.Filter">Filter</a>] = None)</span>
</code></dt>
<dd>
<div class="desc"><p>Obtains all posts from <code>/api/posts</code>, optionally filtering results by using <code>filter</code>.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/CWKevo/pyFlarum/blob/a65fc09d5ae7d6cb04d63d7abe39aabe0cf03c52/pyflarum\session.py#L309-L323" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def get_posts(self, filter: Optional[Filter]=None):
    &#34;&#34;&#34;
        Obtains all posts from `/api/posts`, optionally filtering results by using `filter`.
    &#34;&#34;&#34;

    if filter:
        raw = self.session.get(f&#34;{self.api_urls[&#39;posts&#39;]}&#34;, params=filter.to_dict)

    else:
        raw = self.session.get(f&#34;{self.api_urls[&#39;posts&#39;]}&#34;)

    json = parse_request(raw)


    return Posts(user=self, _fetched_data=json)</code></pre>
</details>
</dd>
<dt id="pyflarum.session.FlarumUser.get_user_by_id"><code class="name flex">
<span>def <span class="ident">get_user_by_id</span></span>(<span>self, id: int) ‑> <a title="pyflarum.flarum.core.users.User" href="flarum/core/users.html#pyflarum.flarum.core.users.User">User</a></span>
</code></dt>
<dd>
<div class="desc"><p>Obtains a user by specific ID.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/CWKevo/pyFlarum/blob/a65fc09d5ae7d6cb04d63d7abe39aabe0cf03c52/pyflarum\session.py#L256-L265" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def get_user_by_id(self, id: int) -&gt; User:
    &#34;&#34;&#34;
        Obtains a user by specific ID.
    &#34;&#34;&#34;

    raw = self.session.get(f&#34;{self.api_urls[&#39;users&#39;]}/{id}&#34;)
    json = parse_request(raw)


    return User(user=self, _fetched_data=json)</code></pre>
</details>
</dd>
<dt id="pyflarum.session.FlarumUser.get_users"><code class="name flex">
<span>def <span class="ident">get_users</span></span>(<span>self, filter: <a title="pyflarum.flarum.core.filters.Filter" href="flarum/core/filters.html#pyflarum.flarum.core.filters.Filter">Filter</a> = None) ‑> <a title="pyflarum.flarum.core.users.Users" href="flarum/core/users.html#pyflarum.flarum.core.users.Users">Users</a></span>
</code></dt>
<dd>
<div class="desc"><p>Obtains all users from <code>/api/users</code>, optionally filtering results by using <code>filter</code>.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/CWKevo/pyFlarum/blob/a65fc09d5ae7d6cb04d63d7abe39aabe0cf03c52/pyflarum\session.py#L326-L341" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def get_users(self, filter: Filter=None) -&gt; Users:
    &#34;&#34;&#34;
        Obtains all users from `/api/users`, optionally filtering results by using `filter`.
    &#34;&#34;&#34;


    if filter:
        raw = self.session.get(f&#34;{self.api_urls[&#39;users&#39;]}&#34;, params=filter.to_dict)

    else:
        raw = self.session.get(f&#34;{self.api_urls[&#39;users&#39;]}&#34;)

    json = parse_request(raw)


    return Users(user=self, _fetched_data=json)</code></pre>
</details>
</dd>
<dt id="pyflarum.session.FlarumUser.mark_all_discussions_as_read"><code class="name flex">
<span>def <span class="ident">mark_all_discussions_as_read</span></span>(<span>self, at: datetime.datetime = datetime.datetime(2021, 8, 28, 13, 15, 16, 651943)) ‑> Literal[True]</span>
</code></dt>
<dd>
<div class="desc"><p>Marks all discussions as read.</p>
<p>Specify <code>at</code> to mark discussions as read at a specific date (strange how this is allowed, might be
because of timezones).</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/CWKevo/pyFlarum/blob/a65fc09d5ae7d6cb04d63d7abe39aabe0cf03c52/pyflarum\session.py#L362-L384" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def mark_all_discussions_as_read(self, at: datetime=datetime.now()) -&gt; Literal[True]:
    &#34;&#34;&#34;
        Marks all discussions as read.

        Specify `at` to mark discussions as read at a specific date (strange how this is allowed, might be
        because of timezones).
    &#34;&#34;&#34;

    post_data = {
        &#34;data&#34;: {
            &#34;type&#34;: &#34;users&#34;,
            &#34;id&#34;: self.data.id,
            &#34;attributes&#34;: {
                &#34;markedAllAsReadAt&#34;: datetime_to_flarum(at)
            }
        }
    }

    raw = self.session.patch(f&#34;{self.api_urls[&#39;users&#39;]}/{self.data.id}&#34;, json=post_data)
    parse_request(raw)


    return True</code></pre>
</details>
</dd>
<dt id="pyflarum.session.FlarumUser.mark_all_notifications_as_read"><code class="name flex">
<span>def <span class="ident">mark_all_notifications_as_read</span></span>(<span>self) ‑> Literal[True]</span>
</code></dt>
<dd>
<div class="desc"><p>Marks all notifications as read. Returns <code>True</code> when successful.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/CWKevo/pyFlarum/blob/a65fc09d5ae7d6cb04d63d7abe39aabe0cf03c52/pyflarum\session.py#L387-L396" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def mark_all_notifications_as_read(self) -&gt; Literal[True]:
    &#34;&#34;&#34;
        Marks all notifications as read. Returns `True` when successful.
    &#34;&#34;&#34;

    raw = self.session.post(f&#34;{self.api_urls[&#39;notifications&#39;]}/read&#34;)
    parse_request(raw)


    return True</code></pre>
</details>
</dd>
<dt id="pyflarum.session.FlarumUser.remove_user_avatar"><code class="name flex">
<span>def <span class="ident">remove_user_avatar</span></span>(<span>self, user: Optional[ForwardRef('AnyUser')] = None) ‑> <a title="pyflarum.session.FlarumUser" href="#pyflarum.session.FlarumUser">FlarumUser</a> | User</span>
</code></dt>
<dd>
<div class="desc"><p>Removes your user's avatar. If <code>user</code> is specified, then avatar of that user is removed.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/CWKevo/pyFlarum/blob/a65fc09d5ae7d6cb04d63d7abe39aabe0cf03c52/pyflarum\session.py#L539-L548" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def remove_user_avatar(self, user: Optional[&#39;AnyUser&#39;]=None) -&gt; &#39;FlarumUser | User&#39;:
    &#34;&#34;&#34;
        Removes your user&#39;s avatar. If `user` is specified, then avatar of that user is removed.
    &#34;&#34;&#34;

    raw = self.session.delete(url=f&#34;{self.api_urls[&#39;users&#39;]}/{user.id if user else self.data.id}/avatar&#34;)
    json = parse_request(raw)


    return self._update_user_data(new_data=json)</code></pre>
</details>
</dd>
<dt id="pyflarum.session.FlarumUser.send_password_reset_email"><code class="name flex">
<span>def <span class="ident">send_password_reset_email</span></span>(<span>self) ‑> <a title="pyflarum.session.FlarumUser" href="#pyflarum.session.FlarumUser">FlarumUser</a> | User</span>
</code></dt>
<dd>
<div class="desc"><p>Allows you to send yourself a password reset E-mail.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/CWKevo/pyFlarum/blob/a65fc09d5ae7d6cb04d63d7abe39aabe0cf03c52/pyflarum\session.py#L451-L462" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def send_password_reset_email(self) -&gt; &#39;FlarumUser | User&#39;:
    &#34;&#34;&#34;
        Allows you to send yourself a password reset E-mail.
    &#34;&#34;&#34;

    patch_data = {&#34;email&#34;: self.data.email}

    raw = self.session.patch(f&#34;{self.api_urls[&#39;users&#39;]}/{self.data.id}&#34;, json=patch_data)
    json = parse_request(raw)


    return self._update_user_data(new_data=dict(data=json))</code></pre>
</details>
</dd>
<dt id="pyflarum.session.FlarumUser.update_preferences"><code class="name flex">
<span>def <span class="ident">update_preferences</span></span>(<span>self, preferences: Iterable[tuple[str, Any]], user: Optional[ForwardRef('AnyUser')] = None) ‑> <a title="pyflarum.session.FlarumUser" href="#pyflarum.session.FlarumUser">FlarumUser</a> | User</span>
</code></dt>
<dd>
<div class="desc"><p>Updates an user's preferences.</p>
<p>If no user is specified, then your user is updated.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/CWKevo/pyFlarum/blob/a65fc09d5ae7d6cb04d63d7abe39aabe0cf03c52/pyflarum\session.py#L465-L493" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def update_preferences(self, preferences: Iterable[tuple[str, Any]], user: Optional[&#39;AnyUser&#39;]=None) -&gt; &#39;FlarumUser | User&#39;:
    &#34;&#34;&#34;
        Updates an user&#39;s preferences.

        If no user is specified, then your user is updated.
    &#34;&#34;&#34;

    id = user.id if user else self.data.id

    patch_data = {
        &#34;data&#34;: {
            &#34;type&#34;: &#34;users&#34;,
            &#34;id&#34;: id,
            &#34;attributes&#34;: {
                &#34;preferences&#34;: {}
            }
        }
    }


    for preference, value in preferences:
        patch_data[&#39;data&#39;][&#39;attributes&#39;][&#39;preferences&#39;][preference] = value


    raw = self.session.patch(f&#34;{self.api_urls[&#39;users&#39;]}/{id}&#34;, json=patch_data)
    json = parse_request(raw)


    return self._update_user_data(new_data=json)</code></pre>
</details>
</dd>
<dt id="pyflarum.session.FlarumUser.update_user_info"><code class="name flex">
<span>def <span class="ident">update_user_info</span></span>(<span>self, user: Optional[ForwardRef('AnyUser')] = None, new_username: Optional[str] = None, groups: Optional[ForwardRef('list[str | int] | list[Group] | Groups')] = None) ‑> <a title="pyflarum.session.FlarumUser" href="#pyflarum.session.FlarumUser">FlarumUser</a> | User</span>
</code></dt>
<dd>
<div class="desc"><p>Updates the info of a user (this can be your user or someone else).</p>
<p>If you are updating yourself, then <code><a title="pyflarum.session.FlarumUser" href="#pyflarum.session.FlarumUser">FlarumUser</a></code> is returned (with the new data).
If you are updating someone else, then the updated <code>User</code> is returned.</p>
<h3 id="parameters">Parameters:</h3>
<ul>
<li><code>user</code> - the user to update.</li>
<li><code>new_username</code> - the user's new username.</li>
<li><code>groups</code> - new groups of the user. This can either be a list of <code><a title="pyflarum.flarum.core.groups.Group" href="flarum/core/groups.html#pyflarum.flarum.core.groups.Group">Group</a></code> objects,
or just one <code><a title="pyflarum.flarum.core.groups.Groups" href="flarum/core/groups.html#pyflarum.flarum.core.groups.Groups">Groups</a></code>, or a list of <code>str</code> or <code>int</code> representing the group IDs.</li>
</ul></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/CWKevo/pyFlarum/blob/a65fc09d5ae7d6cb04d63d7abe39aabe0cf03c52/pyflarum\session.py#L411-L448" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def update_user_info(self, user: Optional[&#39;AnyUser&#39;]=None, new_username: Optional[str]=None, groups: Optional[&#39;list[str | int] | list[Group] | Groups&#39;]=None) -&gt; &#39;FlarumUser | User&#39;:
    &#34;&#34;&#34;
        Updates the info of a user (this can be your user or someone else).

        If you are updating yourself, then `FlarumUser` is returned (with the new data).
        If you are updating someone else, then the updated `User` is returned.

        ### Parameters:
        - `user` - the user to update.
        - `new_username` - the user&#39;s new username.
        - `groups` - new groups of the user. This can either be a list of `pyflarum.flarum.core.groups.Group` objects,
        or just one `pyflarum.flarum.core.groups.Groups`, or a list of `str` or `int` representing the group IDs.
    &#34;&#34;&#34;

    id = user.id if user else self.data.id

    patch_data = {
        &#34;data&#34;: {
            &#34;type&#34;: &#34;users&#34;,
            &#34;id&#34;: id,
            &#34;attributes&#34;: {},
            &#34;relationships&#34;: {}
        }
    } # type: dict[str, dict[str, dict]]


    if new_username:
        patch_data[&#39;attributes&#39;][&#39;username&#39;] = new_username

    if groups:
        patch_data[&#39;data&#39;][&#39;relationships&#39;].update({&#34;groups&#34;: {&#34;data&#34;: [group.id if isinstance(group, Group) else group for group in groups]}})


    raw = self.session.patch(f&#34;{self.api_urls[&#39;users&#39;]}/{id}&#34;, json=patch_data)
    json = parse_request(raw)


    return self._update_user_data(new_data=json)</code></pre>
</details>
</dd>
<dt id="pyflarum.session.FlarumUser.upload_user_avatar"><code class="name flex">
<span>def <span class="ident">upload_user_avatar</span></span>(<span>self, file: <class 'BinaryIO'>, user: Optional[ForwardRef('AnyUser')] = None, file_name: str = 'avatar', file_type: Literal['image/png', 'image/jpeg', 'image/gif'] = 'image/png') ‑> <a title="pyflarum.session.FlarumUser" href="#pyflarum.session.FlarumUser">FlarumUser</a> | User</span>
</code></dt>
<dd>
<div class="desc"><p>Uploads an avatar for yourself. If <code>user</code> is specified, then avatar of that user is changed.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/CWKevo/pyFlarum/blob/a65fc09d5ae7d6cb04d63d7abe39aabe0cf03c52/pyflarum\session.py#L525-L536" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def upload_user_avatar(self, file: BinaryIO, user: Optional[&#39;AnyUser&#39;]=None, file_name: str=&#34;avatar&#34;, file_type: Literal[&#39;image/png&#39;, &#39;image/jpeg&#39;, &#39;image/gif&#39;]=&#34;image/png&#34;) -&gt; &#39;FlarumUser | User&#39;:
    &#34;&#34;&#34;
        Uploads an avatar for yourself. If `user` is specified, then avatar of that user is changed.
    &#34;&#34;&#34;

    id = user.id if user else self.data.id

    raw = self.session.post(url=f&#34;{self.api_urls[&#39;users&#39;]}/{id}/avatar&#34;, files={ &#34;avatar&#34;: (file_name, file, file_type) })
    json = parse_request(raw)


    return self._update_user_data(new_data=json)</code></pre>
</details>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<form>
<input id="lunr-search" name="q" placeholder="🔎 Search ..." aria-label="Search"
disabled minlength="2">
</form>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/tingle/0.15.3/tingle.min.css" integrity="sha512-j1u8eUJ4f23xPPxwOrLUPQaCD2dwzNqqmDDcWS4deWsMv2ohLqmXXuP3hU7g8TyzbMSakP/mMqoNBYWj8AEIFg==" crossorigin>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tingle/0.15.3/tingle.min.js" integrity="sha512-plGUER9JkeEWPPqQBE4sdLqBoQug5Ap+BCGMc7bJ8BXkm+VVj6QzkpBz5Yv2yPkkq+cqg9IpkBaGCas6uDbW8g==" crossorigin></script>
<style>
.modal-dialog iframe {
width: 100vw;
height: calc(100vh - 80px);
}
@media screen and (min-width: 700px) {
.modal-dialog iframe {
width: 70vw;
height: 80vh;
}
}
.modal-dialog .tingle-modal-box {width: auto;}
.modal-dialog .tingle-modal-box__content {padding: 0;}
</style>
<script>
const input = document.getElementById('lunr-search');
input.disabled = false;
input.form.addEventListener('submit', (ev) => {
ev.preventDefault();
const url = new URL(window.location);
url.searchParams.set('q', input.value);
history.replaceState({}, null, url.toString());
search(input.value);
});
const query = new URL(window.location).searchParams.get('q');
if (query)
search(query);
function search(query) {
const url = '../doc-search.html#' + encodeURIComponent(query);
new tingle.modal({
cssClass: ['modal-dialog'],
onClose: () => {
const url = new URL(window.location);
url.searchParams.delete('q');
history.replaceState({}, null, url.toString());
setTimeout(() => input.focus(), 100);
}
}).setContent('<iframe src="' + url + '"></iframe>').open();
}
</script>
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="pyflarum" href="index.html">pyflarum</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="pyflarum.session.FlarumSession" href="#pyflarum.session.FlarumSession">FlarumSession</a></code></h4>
<ul class="">
<li><code><a title="pyflarum.session.FlarumSession.api_urls" href="#pyflarum.session.FlarumSession.api_urls">api_urls</a></code></li>
<li><code><a title="pyflarum.session.FlarumSession.authenticate" href="#pyflarum.session.FlarumSession.authenticate">authenticate</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="pyflarum.session.FlarumUser" href="#pyflarum.session.FlarumUser">FlarumUser</a></code></h4>
<ul class="">
<li><code><a title="pyflarum.session.FlarumUser.api_urls" href="#pyflarum.session.FlarumUser.api_urls">api_urls</a></code></li>
<li><code><a title="pyflarum.session.FlarumUser.authenticate" href="#pyflarum.session.FlarumUser.authenticate">authenticate</a></code></li>
<li><code><a title="pyflarum.session.FlarumUser.change_email" href="#pyflarum.session.FlarumUser.change_email">change_email</a></code></li>
<li><code><a title="pyflarum.session.FlarumUser.get_discussion_by_id" href="#pyflarum.session.FlarumUser.get_discussion_by_id">get_discussion_by_id</a></code></li>
<li><code><a title="pyflarum.session.FlarumUser.get_discussions" href="#pyflarum.session.FlarumUser.get_discussions">get_discussions</a></code></li>
<li><code><a title="pyflarum.session.FlarumUser.get_forum_data" href="#pyflarum.session.FlarumUser.get_forum_data">get_forum_data</a></code></li>
<li><code><a title="pyflarum.session.FlarumUser.get_groups" href="#pyflarum.session.FlarumUser.get_groups">get_groups</a></code></li>
<li><code><a title="pyflarum.session.FlarumUser.get_notifications" href="#pyflarum.session.FlarumUser.get_notifications">get_notifications</a></code></li>
<li><code><a title="pyflarum.session.FlarumUser.get_post_by_id" href="#pyflarum.session.FlarumUser.get_post_by_id">get_post_by_id</a></code></li>
<li><code><a title="pyflarum.session.FlarumUser.get_posts" href="#pyflarum.session.FlarumUser.get_posts">get_posts</a></code></li>
<li><code><a title="pyflarum.session.FlarumUser.get_user_by_id" href="#pyflarum.session.FlarumUser.get_user_by_id">get_user_by_id</a></code></li>
<li><code><a title="pyflarum.session.FlarumUser.get_users" href="#pyflarum.session.FlarumUser.get_users">get_users</a></code></li>
<li><code><a title="pyflarum.session.FlarumUser.mark_all_discussions_as_read" href="#pyflarum.session.FlarumUser.mark_all_discussions_as_read">mark_all_discussions_as_read</a></code></li>
<li><code><a title="pyflarum.session.FlarumUser.mark_all_notifications_as_read" href="#pyflarum.session.FlarumUser.mark_all_notifications_as_read">mark_all_notifications_as_read</a></code></li>
<li><code><a title="pyflarum.session.FlarumUser.remove_user_avatar" href="#pyflarum.session.FlarumUser.remove_user_avatar">remove_user_avatar</a></code></li>
<li><code><a title="pyflarum.session.FlarumUser.send_password_reset_email" href="#pyflarum.session.FlarumUser.send_password_reset_email">send_password_reset_email</a></code></li>
<li><code><a title="pyflarum.session.FlarumUser.update_preferences" href="#pyflarum.session.FlarumUser.update_preferences">update_preferences</a></code></li>
<li><code><a title="pyflarum.session.FlarumUser.update_user_info" href="#pyflarum.session.FlarumUser.update_user_info">update_user_info</a></code></li>
<li><code><a title="pyflarum.session.FlarumUser.upload_user_avatar" href="#pyflarum.session.FlarumUser.upload_user_avatar">upload_user_avatar</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.9.2</a>.</p>
</footer>
</body>
</html>